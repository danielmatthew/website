---
import { CollectionEntry, getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import TableOfContents from "../../components/TableOfContents.astro";
interface Props {
  entry: CollectionEntry<"work">;
}

export async function getStaticPaths() {
  const work = await getCollection("work", ({data}) => {
    return data.draft !== true;
  });
  return work.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content, headings } = await entry.render();

---

<BaseLayout
  title={entry.data.title}
>
  <main class="wrapper">
    <article>
      <header>
        <div class="flow masthead">
          <h1>{entry.data.title}</h1>

          <div class="meta">
            <span class="org">Talis</span>
            <time datetime={entry.data.publishDate.toISOString()}>
              {entry.data.projectDate}
            </time>
          </div>
          {
            entry.data.tags && (
              <ul class="roles">
                {entry.data.tags.map((role) => (
                  <li>{role}</li>
                ))}
              </ul>
            )
          }
        </div>
      </header>
      <section class="layout">

        <div class="summary flow">
          <strong>TL; DR</strong>
          <p class="lede">
            {entry.data.description}
          </p>
        </div>

        <!-- <TableOfContents headings={headings} /> -->

        <div class="content flow">
          <Content />

        </div>
      </section>
    </article>
  </main>
</BaseLayout>
<style>


  .roles {
    list-style-type: none;
    padding: 0;
    margin-block-end: 0;
  }

  .meta,
  .roles {
    display: flex;
    font-size: var(--step-0);
  }

  .meta {
    margin-block-start: var(--space-s);
  }

  .roles {
    font-size: var(--step--1);
    flex-wrap: wrap;
  }

  .meta > *:not(:last-child)::after {
    content: "Â·";
    padding-inline-start: var(--space-3xs);
    margin-inline-end: var(--space-3xs);
  }

  .meta > * + * {
    margin-top: 0;
  }

</style>
